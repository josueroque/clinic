<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script> -->
    <link rel='stylesheet' href='/stylesheets/style.css' />
    <!-- <script type="text/javascript" src="C:\Clinica Node\ClinicaAndrade\public\javascripts\clinic.js"></script> -->
  </head>

  <body>
   
    <h1>Clinical History</h1>
    <h2>General Information</h2>
    <div class="wrapper"> 
    <div class="accordion">
        <button class="accordion">Pacient</button>
        <div class="panel">
          <p><a href="historial" style="text-decoration:none ">Save History</a></p>
          <p><a href="patientList" style="text-decoration:none ">Pacients List</a></p>
        </div>
        <button class="accordion">Section 2</button>
        <div class="panel">
          <p>Lorem ipsum...</p>
        </div>
        
        <button class="accordion">Section 3</button>
        <div class="panel">
          <p>Lorem ipsum...</p>
        </div> 
    </div>
        <form method="POST" action="/historial" id="formHist" value="prueba">
          <div class="form">
            <label for="idNumber">Id Number</label>
            <input type="text" name="idNumber"  id="id" required class="text"value="<%= data.idNumber%>">
          </div>
          <div class="form">
            <label for="name">Name</label>
            <input type="text" name="name" required class="text" value="<%= data.name%>" ></div>
          <div class="form">
            <label for="lastName">Last Name</label>
            <input type="text" name="lastName" required class="text" value="<%= data.lastName%>">
          </div>
          <div class="radio">
         
            <label for="socialInsurance" >Does the pacient have social insurance?</label>
                     
          <p>
            <% if(data.socialInsurance===true) { %>
              <input type="radio" name="socialInsurance" checked=true class="yes" value=true >Yes</input>
            <% } else { %> 
              <input type="radio" name="socialInsurance"  class="yes" value=true >Yes</input>
            <% }  %> 
          </p>
          <p>
            <% if(data.socialInsurance===true) { %>
              <input type="radio" name="socialInsurance"  class="no" value=false >No</input>
            <% } else { %> 
              <input type="radio" name="socialInsurance" checked class="no" value=false >No</input>
            <% }  %> 
          </p>
          </div>
          <div class="form">
            <!-- <label for="address" style="position: absolute; display: inline-block;margin-top:2%;">Address</label> -->
            <label for="address" >Address</label>
            <textarea  name="address"  required class="text"><%= data.address %></textarea>
          </div>
          <div class="form">
            <label for="city">City</label>
            <input type="text" name="city" required class="text" value="<%=data.city %>">
          </div>
          <div class="form">
            <label for="phone">Phone</label>
            <input type="text" name="phone" required class="text" value="<%=data.phone %>">
          </div>
          <div class="form">
            <label for="birthday">Birthday</label>
            <input type="date" name="birthday" required class="text" value="<%=data.birthday %>">
          </div>
          <div class="form">
            <label for="race">Ethnic Group</label>
            <select name="race" class="list"  id="selectRace" >
              <option value="white">White</option>
              <option value="hispanic">Hispanic</option>
              <option value="black" >Black</option>
              <option value="other">Other</option>
            </select> 
          </div>
          <div class="form">
            <label for="educationLevel">Education Level</label>
            <select name="educationLevel" class="list" id="selectEducation">
              <option value="none">None</option>
              <option value="elementary">Elementary</option>
              <option value="highSchool">High School</option>
              <option value="college">College</option>
            </select> 
          </div>
          <div class="form">
            <label for="maritalStatus">Marital Status</label>
            <select name="maritalStatus" id="selectStatus" class="list">
              <option value="single">Single</option>
              <option value="married">Married</option>
              <option value="divorced">Divorced</option>
              <option value="widow">Widow</option>
            </select> 
          </div class="form">
          <div class="radio">
            <label for="knowWriteRead">Does the pacient knows write and read?</label>
            <p>
                <% if(data.knowWriteRead ===true) { %>
                  <input type="radio" name="knowWriteRead" class="yes" checked=true value=true>Yes</input>
                <% } else { %> 
                  <input type="radio" name="knowWriteRead"  class="yes" value=true >Yes</input>
                <% }  %> 
            </p>
            <p>
                <% if(data.knowWriteRead===true) { %>
                  <input type="radio" name="knowWriteRead" class="no"  value=false>No</input>
                <% } else { %> 
                  <input type="radio" name="knowWriteRead"  class="no" checked=true value=false >No</input>
                <% }  %> 
            </p>
          </div>
          <div class="radio">
            <label for="livesAlone">Lives Alone?</label>
            <p>
                <% if(data.livesAlone===true) { %>
                  <input type="radio" name="livesAlone" class="yes" checked=true value=true>Yes</input>
                <% } else { %> 
                  <input type="radio" name="livesAlone"  class="yes" value=true >Yes</input>
                <% }  %> 
            </p>
            <p>
                <% if(data.livesAlone===true) { %>
                  <input type="radio" name="livesAlone" class="no"  value=false>No</input>
                <% } else { %> 
                  <input type="radio" name="livesAlone"  class="no" checked=true value=false >No</input>
                <% }  %> 
            </p>
            </div>
          <div class="form">
            <label for="controlPlace">Control Place</label>
            <input type="text" name="controlPlace" required value="<%= data.controlPlace %>"> 
          </div>
          <div class="form">
            <label for="childbirthPlace"> Child birth place</label>
            <input type="text" name="childbirthPlace" required value="<%= data.childbirthPlace %>">
          </div>

          </br>   
         
          
            <input type="submit" value="Guardar" class="center btn" id="guardar" >
            <!-- <input type="submit" value="Regresar" class="center  btn btn-secondary" id="modificar" > -->
        
            
          
        </form>
      </div>
      <script>
        var acc = document.getElementsByClassName("accordion");
        var i;
        var patient1={};
        for (i = 0; i < acc.length; i++) {
          acc[i].addEventListener("click", function() {
            this.classList.toggle("active");
            var panel = this.nextElementSibling;
            if (panel.style.maxHeight){
              panel.style.maxHeight = null;
            } else {
              panel.style.maxHeight = panel.scrollHeight + "px";
            } 
          });
        }
      let txt=document.getElementById("id").value;
     
      //console.log('id '+txt);
     if (document.getElementById("id").value!==""){ 
      let ruta='http://localhost:3000/patient?id='+txt;
      fetch(ruta).then(function(response) {
       return response.json();
      }).then(function(data) {
       console.log(data[0]);
        patient1=data[0];
        document.getElementById("selectRace").value= patient1['race'];
        document.getElementById("selectStatus").value= patient1['maritalStatus'];
        document.getElementById("selectEducation").value= patient1['educationLevel'];
        if (patient1['idNumber']){
          console.log(patient1['idNumber']);
          document.getElementById("formHist").action="/modificar";
        }
       
        console.log(document.getElementById("formHist").action);
      });  
    }
        </script>
  </body>
</html>
